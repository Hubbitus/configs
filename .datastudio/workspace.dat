0.0.tx=SELECT * FROM history.logged_actions LIMIT 100\n/\n\nSELECT COUNT(*)\nFROM\n\tbo_party party\n\t,bo_document_base underlying\n\t,lu_doc_type doctype\n\t,bo_document_base doc\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_contract_forest_declaration contract\n\t,(\n\t\tSELECT\n\t\t\tunder_contract.id\n\t\t\t,CAST(\n\t\t\t\tCASE\n\t\t\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\t\tWHEN '' THEN '-1'\n\t\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\tEND AS integer\n\t\t\t) as bo_state_authority_fkey\n\t\tFROM\n\t\t\tbo_contract_forest_declaration under_contract\n\t\t\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\t\t\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n\t) declaration_to_authority\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND contract.bo_document_underlying_fkey\=underlying.id\n\tAND doctype.id\=underlying.doc_type_fkey\n\tAND contract.id\=declaration_to_authority.id\n\tAND state_authority.id\=declaration_to_authority.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n//\tAND party.inn \= $1\n//\tAND (\n//\t\tdoc.lu_land_type_fkey \= $2 AND const_entity.id\=$3\n//\t)\n/\n\n//set enable_seqscan\=no;\n\nSET enable_nestloop \= no\n/\n\nSET enable_seqscan \= no\n/\n\nSET enable_indexscan \= no\nSET enable_tidscan \= no\nSET enable_sort \= no\nSET enable_mergejoin \= no\nSET enable_hashjoin \= no\n\n/\n\n//EXPLAIN ANALYZE\nSELECT COUNT(1)\nFROM\n\tbo_party party\n\t,bo_document_base underlying\n\t,lu_doc_type doctype\n\t,bo_document_base doc\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_contract_forest_declaration contract\n\t,(\n\t\tSELECT\n\t\t\tunder_contract.id\n\t\t\t,CAST(\n\t\t\t\tCASE\n\t\t\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\t\tWHEN '' THEN '-1'\n\t\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\tEND AS integer\n\t\t\t) as bo_state_authority_fkey\n\t\tFROM\n\t\t\tbo_contract_forest_declaration under_contract\n\t\t\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\t\t\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n\t) declaration_to_authority\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND contract.bo_document_underlying_fkey\=underlying.id\n\tAND doctype.id\=underlying.doc_type_fkey\n\tAND contract.id\=declaration_to_authority.id\n\tAND state_authority.id\=declaration_to_authority.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND party.inn \= '1004008820' // $1\n\tAND (\n\t\tdoc.lu_land_type_fkey \= 1 /* $2 */ AND const_entity.id \= 10 // $3\n\t)\n/\n\nCREATE EXTENSION pg_stat_statements;\n\n/\n\nSELECT *\nFROM pg_stat_statements\nORDER BY total_time DESC\n/\n\nSELECT COUNT(*)\nFROM bo_contract_forest_declaration\n/\n\nSELECT * FROM schema_version\n// WHERE version \= '3.0.24'\n/\n\n-------------------------------------\n\nSELECT datname,usename,procpid,client_addr,waiting,query_start,current_query\nFROM pg_stat_activity\n/\n\nSELECT *\nFROM pg_stat_activity\nWHERE\n\tstate \= 'active'\n\tAND procpid \= pg_backend_pid();\n/\n\nSELECT *\nFROM bo_hardwood_deal_report\n/\n\nSELECT *\nFROM history.logged_actions\nWHERE\n//\tclient_query LIKE '%0001002721188602002721185312%'\n//\trow_data\:\:text LIKE '%0001002721188602002721185312%'\n//\trow_data\:\:text LIKE '%P_412054%'\n\trow_data @> 'id\=>P_412054' -- bo_contract_hardwood_deal.bo_document_fkey\n/\n\nSELECT *\nFROM bo_hardwood_deal_details\n/\n\nSELECT to_char(create_date, 'yyyy-MM-DD HH24\:MI\:SS.MS'), *\nFROM bo_contract_hardwood_deal\nWHERE\n\tmain_deal_number \= '0001002721188602002721185312'\n/\n\nSELECT\n\tt.column1\nFROM (\n\tVALUES('a\=>1,b\=>2'\:\:hstore), ('a\=>2,b\=>3'\:\:hstore)\n) t\nWHERE\n\tt.column1 @> 'a\=>1'
1.0.tx=EXPLAIN ANALYZE\nSELECT\n//\tCOUNT(1)\n\t*\nFROM\n\tbo_party party\n\t,bo_document_base underlying\n\t,lu_doc_type doctype\n\t,bo_document_base doc\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_contract_forest_declaration contract\n\t,(\n\t\tSELECT\n\t\t\tunder_contract.id\n\t\t\t,CAST(\n\t\t\t\tCASE\n\t\t\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\t\tWHEN '' THEN '-1'\n\t\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\tEND AS integer\n\t\t\t) as bo_state_authority_fkey\n\t\tFROM\n\t\t\tbo_contract_forest_declaration under_contract\n\t\t\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\t\t\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n\t) declaration_to_authority\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND contract.bo_document_underlying_fkey\=underlying.id\n\tAND doctype.id\=underlying.doc_type_fkey\n\tAND contract.id\=declaration_to_authority.id\n\tAND state_authority.id\=declaration_to_authority.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND party.inn \= '1004008820' // $1\n\tAND (\n\t\tdoc.lu_land_type_fkey \= 1 /* $2 */ AND const_entity.id \= 10 // $3\n\t)\n/\n\nSELECT\n\t*\nFROM\n\tbo_party party\n\t,bo_document_base underlying\n\t,lu_doc_type doctype\n\t,bo_document_base doc\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_contract_forest_declaration contract\n\t,(\n\t\tSELECT\n\t\t\tunder_contract.id\n\t\t\t,CAST(\n\t\t\t\tCASE\n\t\t\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\t\tWHEN '' THEN '-1'\n\t\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\tEND AS integer\n\t\t\t) as bo_state_authority_fkey\n\t\tFROM\n\t\t\tbo_contract_forest_declaration under_contract\n\t\t\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\t\t\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n\t) declaration_to_authority\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND contract.bo_document_underlying_fkey\=underlying.id\n\tAND doctype.id\=underlying.doc_type_fkey\n\tAND contract.id\=declaration_to_authority.id\n\tAND state_authority.id\=declaration_to_authority.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND party.inn \= '1004008820' // $1\n\tAND (\n\t\tdoc.lu_land_type_fkey \= 1 /* $2 */ AND const_entity.id \= 10 // $3\n\t)\n/\n\nSELECT * FROM schema_version\n// WHERE version \= '3.0.24'\n//1521301864\n/\n\nUPDATE schema_version SET checksum \= -1866377995 WHERE version \= '3.0.24'\n
2.0.tx=EXPLAIN ANALYZE\nSELECT COUNT(1)\nFROM\n\tbo_party party\n\t,bo_document_base underlying\n\t,lu_doc_type doctype\n\t,bo_document_base doc\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_contract_forest_declaration contract\n\t,(\n\t\tSELECT\n\t\t\tunder_contract.id\n\t\t\t,CAST(\n\t\t\t\tCASE\n\t\t\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\t\tWHEN '' THEN '-1'\n\t\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\tEND AS integer\n\t\t\t) as bo_state_authority_fkey\n\t\tFROM\n\t\t\tbo_contract_forest_declaration under_contract\n\t\t\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\t\t\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n\t) declaration_to_authority\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND contract.bo_document_underlying_fkey\=underlying.id\n\tAND doctype.id\=underlying.doc_type_fkey\n\tAND contract.id\=declaration_to_authority.id\n\tAND state_authority.id\=declaration_to_authority.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND party.inn \= '1004008820' // $1\n\tAND (\n\t\tdoc.lu_land_type_fkey \= 1 /* $2 */ AND const_entity.id \= 10 // $3\n\t)\n/\n\n// Join variant\nEXPLAIN ANALYZE\nSELECT COUNT(1)\nFROM\n\tbo_party party\n\tJOIN bo_contract_forest_declaration contract\n\t\tON (contract.bo_party_fkey \= party.id)\n\tJOIN bo_document_base underlying\n\t\tON (underlying.id \= contract.bo_document_underlying_fkey)\n\tJOIN lu_doc_type doctype\n\t\tON (doctype.id \= underlying.doc_type_fkey)\n\tJOIN bo_document_base doc\n\t\tON (doc.id \= contract.bo_document_fkey)\n\tJOIN (\n\t\tSELECT\n\t\t\tunder_contract.id\n//\t\t\t,CAST(\n//\t\t\t\tCASE\n//\t\t\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n//\t\t\t\t\tWHEN '' THEN '-1'\n//\t\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n//\t\t\t\tEND AS integer\n//\t\t\t) as bo_state_authority_fkey\n\t\t\t,concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\:\:integer as bo_state_authority_fkey\n\t\tFROM\n\t\t\tbo_contract_forest_declaration under_contract\n\t\t\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\t\t\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\t\t\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n\t) declaration_to_authority\n\t\tON (declaration_to_authority.id \= contract.id)\n\tJOIN bo_state_authority state_authority\n\t\tON (state_authority.id \= declaration_to_authority.bo_state_authority_fkey)\n\tJOIN bo_constituent_entity const_entity\n\t\tON (const_entity.id \= state_authority.bo_constituent_entity_fkey)\n\tJOIN bo_federal_district federal_district\n\t\tON (federal_district.id \= const_entity.bo_federal_district_fkey)\nWHERE\n\t1\=1\n\tAND party.inn \= '1004008820' // $1\n\tAND (\n\t\tdoc.lu_land_type_fkey \= 1 /* $2 */\n\t\tAND const_entity.id \= 10 // $3\n\t)\n\n/\n\n// CTE\nEXPLAIN ANALYZE\nWITH declaration_to_authority AS (\n\tSELECT\n\t\tunder_contract.id\n\t\t,CAST(\n\t\t\tCASE\n\t\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\tWHEN '' THEN '-1'\n\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\tEND AS integer\n\t\t) as bo_state_authority_fkey\n\tFROM\n\t\tbo_contract_forest_declaration under_contract\n\t\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\t\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\t\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\t\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\t\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n)\nSELECT COUNT(1)\nFROM\n\tbo_party party\n\t,bo_document_base underlying\n\t,lu_doc_type doctype\n\t,bo_document_base doc\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_contract_forest_declaration contract\n\t,declaration_to_authority\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND contract.bo_document_underlying_fkey\=underlying.id\n\tAND doctype.id\=underlying.doc_type_fkey\n\tAND contract.id\=declaration_to_authority.id\n\tAND state_authority.id\=declaration_to_authority.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND party.inn \= '1004008820' // $1\n\tAND (\n\t\tdoc.lu_land_type_fkey \= 1 /* $2 */ AND const_entity.id \= 10 // $3\n\t)\n\n/\n\n\nSELECT COUNT(1)\nFROM\n\tbo_party party\n\t,bo_document_base underlying\n\t,lu_doc_type doctype\n\t,bo_document_base doc\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_contract_forest_declaration contract\n\t,declaration_to_authority\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND contract.bo_document_underlying_fkey\=underlying.id\n\tAND doctype.id\=underlying.doc_type_fkey\n\tAND contract.id\=declaration_to_authority.id\n\tAND state_authority.id\=declaration_to_authority.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND party.inn \= '1004008820' // $1\n\tAND (\n\t\tdoc.lu_land_type_fkey \= 1 /* $2 */ AND const_entity.id \= 10 // $3\n\t)\n/\n\nCREATE MATERIALIZED VIEW declaration_to_authority AS\n\tSELECT\n\t\tunder_contract.id\n\t\t,CAST(\n\t\t\tCASE\n\t\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\t\tWHEN '' THEN '-1'\n\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\t\tEND AS integer\n\t\t) as bo_state_authority_fkey\n\tFROM\n\t\tbo_contract_forest_declaration under_contract\n\t\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\t\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\t\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\t\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\t\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n/\n\nCREATE INDEX declaration_to_authority__id__bo_state_authority_fkey ON declaration_to_authority (id, bo_state_authority_fkey)\n/\n\n\n\nCREATE MATERIALIZED VIEW declaration_to_authority__contract_report_v AS\nSELECT\n\tunder_contract.id,\n\tCAST(\n\t\tCASE\n\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\tWHEN\n\t\t\t'' THEN '-1'\n\t\tELSE\n\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\tEND AS INTEGER\n\t) AS bo_state_authority_fkey\nFROM\n\tbo_contract_report under_contract \n\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n/\n\nCREATE INDEX declaration_to_authority_report__id__bo_state_authority_fkey ON declaration_to_authority__contract_report_v (id, bo_state_authority_fkey)\n/\n\nDROP INDEX declaration_to_authority__contract_report_v__id__bo_state_autho\n/\n\nSELECT * FROM declaration_to_authority\n/\n\nSELECT\n\tunder_contract.id\n\t,CAST(\n\t\tCASE\n\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\tWHEN\n\t\t\t'' THEN '-1'\n\t\tELSE\n\t\t\tconcat(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey)\n\t\tEND AS integer\n\t) as bo_state_authority_fkey\nFROM\n\tbo_contract_forest_declaration under_contract\n\tINNER JOIN bo_document_base doc ON (under_contract.bo_document_underlying_fkey\=doc.id)\n\tLEFT JOIN bo_contract_lease lease ON (doc.id \= lease.bo_document_fkey)\n\tLEFT JOIN bo_contract_plants_sale sale ON (doc.id \= sale.bo_document_fkey)\n\tLEFT JOIN bo_contract_forest_works works ON (doc.id \= works.bo_document_fkey)\n\tLEFT JOIN bo_contract_permanent permanent ON (doc.id \= permanent.bo_document_fkey)\n/\n\nSELECT\n\tcontract.id                     AS contract_id,\n\tcontract.bo_document_underlying_fkey,\n\tcontract.create_date,\n\tcontract.update_date,\n\tcontract.created_by,\n\tcontract.updated_by,\n\tdoc.id                          AS document_id,\n\tdoc.contract_num,\n\tdoc.contract_start_date,\n\tdoc.contract_end_date,\n\tdoc.doc_type_text,\n\tdoc.doc_type_fkey,\n\tdoc.source_system,\n\tdoc.updated_by_system,\n\tdoc.source_key,\n\tdoc.id                          AS document_id,\n\tdoc.contract_term_in_months,\n\tdoc.lu_land_type_fkey,\n\tstate_authority.id              AS state_authority_id,\n\tstate_authority.name            AS state_authority_name,\n\tstate_authority.address         AS state_authority_address,\n\tconst_entity.id                 AS const_entity_id,\n\tconst_entity.name               AS const_entity_name,\n\tfederal_district.id             AS federal_district_id,\n\tfederal_district.name           AS federal_district_name,\n\tfederal_district.short_name     AS federal_district_short_name,\n\tfederal_district.short_name_eng AS federal_district_short_name_eng,\n\tunderlying.contract_num         AS underlying_contract_num,\n\tunderlying.contract_start_date  AS underlying_contract_start_date,\n\tunderlying.contract_end_date    AS underlying_contract_end_date,\n\tdoctype.doc_type                AS underlying_doc_type,\n\tdoctype.id                      AS underlying_doc_type_id,\n\tparty.ogrn,\n\tparty.inn,\n\tparty.id                        AS party_id,\n\tparty.party_type_fkey,\n\tparty.form_of_business_fkey,\n\tparty.party_name,\n\tparty.person_last_name,\n\tparty.person_first_name,\n\tparty.person_mid_name,\n\tparty.person_doc_type_fkey,\n\tparty.person_doc_series,\n\tparty.person_doc_num,\n\tparty.physical_address,\n\tCASE \n\t\tWHEN party.party_type_fkey IN (0,\n\t\t2) \n\t\tTHEN party.party_name \n\t\tWHEN party.party_type_fkey IN (1,\n\t\t3) \n\t\tTHEN concat(party.person_last_name, ' ', party.person_first_name,' ', \n\t\tparty.person_mid_name)\n\t\tELSE '' \n\tEND                                 AS pname \nFROM\n\tbo_party party,\n\tbo_document_base underlying,\n\tlu_doc_type doctype,\n\tbo_document_base doc,\n\tbo_state_authority state_authority,\n\tbo_constituent_entity const_entity,\n\tbo_federal_district federal_district,\n\tbo_contract_report contract,\n\t(\tSELECT\n\t\t\tunder_contract.id,\n\t\t\tCAST(\n\t\t\tCASE concat(lease.bo_state_authority_fkey, sale.\n\t\t\t\tbo_state_authority_fkey, works.bo_state_authority_fkey, \n\t\t\t\tpermanent.bo_state_authority_fkey) \n\t\t\t\tWHEN '' \n\t\t\t\tTHEN '-1' \n\t\t\t\tELSE concat(lease.bo_state_authority_fkey, sale.\n\t\t\t\tbo_state_authority_fkey, works.bo_state_authority_fkey, \n\t\t\t\tpermanent.bo_state_authority_fkey) \n\t\t\tEND AS INTEGER) AS bo_state_authority_fkey \n\t\tFROM\n\t\t\tbo_contract_report under_contract \n\t\t\tINNER JOIN bo_document_base doc \n\t\t\tON under_contract.bo_document_underlying_fkey\=doc.id \n\t\t\tLEFT JOIN bo_contract_lease lease \n\t\t\tON doc.id \= lease.bo_document_fkey \n\t\t\tLEFT JOIN bo_contract_plants_sale sale \n\t\t\tON doc.id \= sale.bo_document_fkey \n\t\t\tLEFT JOIN bo_contract_forest_works works \n\t\t\tON doc.id \= works.bo_document_fkey \n\t\t\tLEFT JOIN bo_contract_permanent permanent \n\t\t\tON doc.id \= permanent.bo_document_fkey) declaration_to_authority \nWHERE\n\tdoc.id\=contract.bo_document_fkey AND\n\tparty.id\=contract.bo_party_fkey AND\n\tcontract.bo_document_underlying_fkey\=underlying.id AND\n\tdoctype.id\=underlying.doc_type_fkey AND\n\tcontract.id\=declaration_to_authority.id AND\n\tstate_authority.id\=declaration_to_authority.bo_state_authority_fkey AND\n\tconst_entity.id\=state_authority.bo_constituent_entity_fkey AND\n\tfederal_district.id\=const_entity.bo_federal_district_fkey AND\n\tCAST(doc.create_date AS DATE) \= (TIMESTAMP '2015-07-06 00\:00\:00')\:\:date AND\n\tCAST(doc.contract_start_date AS DATE) \= TIMESTAMP '2015-07-06 00\:00\:00' AND\n\tparty.inn \= '4423000256' AND\n\t((doc.lu_land_type_fkey \= 1 AND\n\tconst_entity.id\=44)) LIMIT 20 OFFSET 0\n/\n\nstartDate\:Mon Jul 06 00\:00\:00 MSK 2015,createDate\:Mon Jul 06 00\:00\:00 MSK 2015\n/\n\nSELECT '1999-01-08'\:\:date, TIMESTAMP '2015-07-06 00\:00\:00'\:\:date\n/\n\nSELECT * FROM current_settings_values('work_mem', 'enable_seqscan', 'shared_buffers', 'sort_mem', 'maintenance_work_mem', 'constraint_exclusion', 'random_page_cost', 'default_statistics_target');\n/\n\n
3.0.tx=SELECT datname,usename,procpid,client_addr,waiting,query_start,current_query\nFROM pg_stat_activity\n/\n\nSELECT *\nFROM pg_stat_activity\n/\n\nSELECT pg_stat_statements_reset()\n/\n\nSELECT total_time/calls as avg_call_time, *\nFROM pg_stat_statements\nORDER BY total_time DESC, avg_call_time DESC\n/\n\nSELECT *\nFROM pg_stat_pl\n/\n\nEXPLAIN (ANALYZE, BUFFERS)\nSELECT COUNT(*)\nFROM\n\tbo_party party\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_system source_system\n\t,bo_document_base doc\n\t,bo_contract_plants_sale contract\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND state_authority.id\=contract.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey AND federal_district.id\=const_entity.bo_federal_district_fkey AND source_system.id\=doc.source_system\n/\n\nEXPLAIN (ANALYZE, BUFFERS)\nSELECT\n//\t*\n\tCOUNT(*)\n//\tCOUNT(party.id)\nFROM\n\tbo_party party\n\tJOIN bo_contract_plants_sale contract\n\tUSING (id)\n//\tON (contract.bo_party_fkey \= party.id)\n//LIMIT 1\n/\n\nEXPLAIN (ANALYZE, BUFFERS)\nSELECT\n\tCOUNT(*)\n//\tCOUNT(party.id)\nFROM\n\tbo_party party\n/\n\n\nVACUUM VERBOSE ANALYZE\n/\n\nSELECT relallvisible, relpages, *\nFROM pg_class\nWHERE relname IN ('bo_party', 'bo_contract_plants_sale')\n/\n\nSELECT current_setting(name) cur_hr_value, *\nFROM pg_settings\nWHERE name IN(\n\t'work_mem', 'shared_buffers', 'sort_mem', 'maintenance_work_mem', 'effective_cache_size'\n\t,'random_page_cost', 'seq_page_cost', 'cpu_tuple_cost', 'cpu_index_tuple_cost', 'cpu_operator_cost'\n\t,'default_statistics_target'\n\t,'checkpoint_segments', 'checkpoint_completion_target'\n\t,'max_connections'\n\t,'enable_bitmapscan', 'enable_hashagg', 'enable_hashjoin', 'enable_indexscan', 'enable_indexonlyscan', 'enable_material', 'enable_mergejoin', 'enable_nestloop', 'enable_seqscan', 'enable_sort', 'enable_tidscan'\n\t,'constraint_exclusion'\n)\n/\n\nSELECT COUNT(*)\n//\tcreate_date, CAST(create_date as date)\nFROM bo_contract_lease\nWHERE create_date \!\= CAST(create_date as DATE)\nORDER BY 1\n/\n\nSELECT COUNT(*)\n//\tcreate_date, CAST(create_date as date)\nFROM bo_contract_plants_sale\nWHERE create_date \!\= CAST(create_date as DATE)\nORDER BY 1\n\n/\n\nEXPLAIN (ANALYZE, BUFFERS)\nSELECT\n\tCOUNT(1)\nFROM\n\tbo_party party, bo_document_base underlying, lu_doc_type doctype, bo_document_base doc, bo_system source_system, bo_state_authority state_authority, bo_constituent_entity const_entity, bo_federal_district federal_district, bo_contract_forest_declaration contract\n\t,(\n\tSELECT\n\t\tunder_contract.id, COALESCE(lease.bo_state_authority_fkey, sale.bo_state_authority_fkey, works.bo_state_authority_fkey, permanent.bo_state_authority_fkey, -1) AS bo_state_authority_fkey\n\tFROM\n\t\tbo_contract_forest_declaration under_contract \n\t\tINNER JOIN bo_document_base doc \n\t\tON under_contract.bo_document_underlying_fkey\=doc.id \n\t\tLEFT JOIN bo_contract_lease lease \n\t\tON doc.id \= lease.bo_document_fkey \n\t\tLEFT JOIN bo_contract_plants_sale sale \n\t\tON doc.id \= sale.bo_document_fkey \n\t\tLEFT JOIN bo_contract_forest_works works \n\t\tON doc.id \= works.bo_document_fkey \n\t\tLEFT JOIN bo_contract_permanent permanent \n\t\tON doc.id \= permanent.bo_document_fkey\n\t) declaration_to_authority \nWHERE\n\tdoc.id\=contract.bo_document_fkey \n\tAND source_system.id\=doc.source_system \n\tAND party.id\=contract.bo_party_fkey \n\tAND contract.bo_document_underlying_fkey\=underlying.id \n\tAND doctype.id\=underlying.doc_type_fkey \n\tAND contract.id\=declaration_to_authority.id \n\tAND state_authority.id\=declaration_to_authority.bo_state_authority_fkey \n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey \n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n///////////////\n/\n\n\nCREATE MATERIALIZED VIEW bo_contract_plants_sale__v AS\nSELECT\n\tdoc.id AS document_id\n\t,doc.contract_num\n\t,doc.contract_start_date\n\t,doc.contract_end_date\n\t,doc.doc_type_text\n\t,doc.doc_type_fkey\n\t,source_system.id as source_system_id\n\t,source_system.label as source_system_label\n\t,doc.updated_by_system\n\t,doc.source_key\n\t,doc.contract_term_in_months\n\t,doc.lu_land_type_fkey\n\t,const_entity.id as const_entity_id\n\t,const_entity.name as const_entity_name\n\t,state_authority.id as state_authority_id\n\t,state_authority.name as state_authority_name\n\t,state_authority.address as state_authority_address\n\t,federal_district.id as federal_district_id\n\t,federal_district.name as federal_district_name\n\t,federal_district.short_name as federal_district_short_name\n\t,federal_district.short_name_eng as federal_district_short_name_eng\n\t,contract.id AS contract_id\n\t,contract.create_date\n\t,contract.update_date\n\t,contract.created_by\n\t,contract.updated_by\n\t,contract.coniferous_volume\n\t,contract.hardwood_volume\n\t,contract.softwood_volume\n\t,contract.unclassified_volume\n\t,party.ogrn\n\t,party.inn\n\t,party.id AS party_id\n\t,party.party_type_fkey\n\t,party.form_of_business_fkey\n\t,party.party_name\n\t,party.person_last_name\n\t,party.person_first_name\n\t,party.person_mid_name\n\t,party.person_doc_type_fkey\n\t,party.person_doc_series\n\t,party.person_doc_num\n\t,party.physical_address\n\t,CASE\n\t\t\t//0-\u042E\u041B, 1-\u0418\u041F, 2 \u0438\u043D\u043E\u0441\u0442\u0440\u0430\u043D\u043D\u044B\u0439, 3-\u0424\u041B\n\t\t\tWHEN party.party_type_fkey in (0, 2) THEN party.party_name\n\t\t\tWHEN party.party_type_fkey in (1, 3) THEN concat(party.person_last_name, ' ', party.person_first_name,' ', party.person_mid_name)\n\t\t\tELSE ''\n\tEND AS pname\n\t-- end commonFields\n\t,contract.own_needs\n\t,contract.bo_contract_forest_works_fkey\nFROM\n\tbo_party party\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_system source_system\n\t,bo_document_base doc\n\t,bo_contract_plants_sale contract\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND state_authority.id\=contract.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey AND federal_district.id\=const_entity.bo_federal_district_fkey AND source_system.id\=doc.source_system\n/\n\n//EXPLAIN (ANALYZE, BUFFERS)\nSELECT COUNT(*)\nFROM bo_contract_plants_sale__v\n/\n\nCREATE VIEW bo_contract_plants_sale__vv AS\nSELECT\n\tdoc.id AS document_id\n\t,doc.contract_num\n\t,doc.contract_start_date\n\t,doc.contract_end_date\n\t,doc.doc_type_text\n\t,doc.doc_type_fkey\n\t,source_system.id as source_system_id\n\t,source_system.label as source_system_label\n\t,doc.updated_by_system\n\t,doc.source_key\n\t,doc.contract_term_in_months\n\t,doc.lu_land_type_fkey\n\t,const_entity.id as const_entity_id\n\t,const_entity.name as const_entity_name\n\t,state_authority.id as state_authority_id\n\t,state_authority.name as state_authority_name\n\t,state_authority.address as state_authority_address\n\t,federal_district.id as federal_district_id\n\t,federal_district.name as federal_district_name\n\t,federal_district.short_name as federal_district_short_name\n\t,federal_district.short_name_eng as federal_district_short_name_eng\n\t,contract.id AS contract_id\n\t,contract.create_date\n\t,contract.update_date\n\t,contract.created_by\n\t,contract.updated_by\n\t,contract.coniferous_volume\n\t,contract.hardwood_volume\n\t,contract.softwood_volume\n\t,contract.unclassified_volume\n\t,party.ogrn\n\t,party.inn\n\t,party.id AS party_id\n\t,party.party_type_fkey\n\t,party.form_of_business_fkey\n\t,party.party_name\n\t,party.person_last_name\n\t,party.person_first_name\n\t,party.person_mid_name\n\t,party.person_doc_type_fkey\n\t,party.person_doc_series\n\t,party.person_doc_num\n\t,party.physical_address\n\t,CASE\n\t\t\t//0-\u042E\u041B, 1-\u0418\u041F, 2 \u0438\u043D\u043E\u0441\u0442\u0440\u0430\u043D\u043D\u044B\u0439, 3-\u0424\u041B\n\t\t\tWHEN party.party_type_fkey in (0, 2) THEN party.party_name\n\t\t\tWHEN party.party_type_fkey in (1, 3) THEN concat(party.person_last_name, ' ', party.person_first_name,' ', party.person_mid_name)\n\t\t\tELSE ''\n\tEND AS pname\n\t-- end commonFields\n\t,contract.own_needs\n\t,contract.bo_contract_forest_works_fkey\nFROM\n\tbo_party party\n\t,bo_state_authority state_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_system source_system\n\t,bo_document_base doc\n\t,bo_contract_plants_sale contract\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND state_authority.id\=contract.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey AND federal_district.id\=const_entity.bo_federal_district_fkey AND source_system.id\=doc.source_system\n/\n\nSELECT COUNT(*)\nFROM bo_contract_plants_sale__vv\n/\n\nREFRESH MATERIALIZED VIEW bo_contract_plants_sale__v\n/\n\nSELECT\n\tCOUNT(*)\nFROM\n\tbo_party party\n\t,bo_state_authority\tstate_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_system source_system\n\t,bo_document_base doc\n\t,bo_contract_lease contract\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND state_authority.id\=contract.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND source_system.id\=doc.source_system\n/\n\nCREATE MATERIALIZED VIEW bo_contract_lease__v AS\nSELECT\n\tdoc.id AS document_id\n\t,doc.contract_num\n\t,doc.contract_start_date\n\t,doc.contract_end_date\n\t,doc.doc_type_text\n\t,doc.doc_type_fkey\n\t,source_system.id as source_system_id\n\t,source_system.label as source_system_label\n\t,doc.updated_by_system\n\t,doc.source_key\n\t,doc.contract_term_in_months\n\t,doc.lu_land_type_fkey\n\t,const_entity.id as const_entity_id\n\t,const_entity.name as const_entity_name\n\t,state_authority.id as state_authority_id\n\t,state_authority.name as state_authority_name\n\t,state_authority.address as state_authority_address\n\t,federal_district.id as federal_district_id\n\t,federal_district.name as federal_district_name\n\t,federal_district.short_name as federal_district_short_name\n\t,federal_district.short_name_eng as federal_district_short_name_eng\n\t,contract.id AS contract_id\n\t,contract.create_date\n\t,contract.update_date\n\t,contract.created_by\n\t,contract.updated_by\n\t,contract.coniferous_volume\n\t,contract.hardwood_volume\n\t,contract.softwood_volume\n\t,contract.unclassified_volume\n\t,party.ogrn\n\t,party.inn\n\t,party.id AS party_id\n\t,party.party_type_fkey\n\t,party.form_of_business_fkey\n\t,party.party_name\n\t,party.person_last_name\n\t,party.person_first_name\n\t,party.person_mid_name\n\t,party.person_doc_type_fkey\n\t,party.person_doc_series\n\t,party.person_doc_num\n\t,party.physical_address\n\t,CASE\n\t\t\t//0-\u042E\u041B, 1-\u0418\u041F, 2 \u0438\u043D\u043E\u0441\u0442\u0440\u0430\u043D\u043D\u044B\u0439, 3-\u0424\u041B\n\t\t\tWHEN party.party_type_fkey in (0, 2) THEN party.party_name\n\t\t\tWHEN party.party_type_fkey in (1, 3) THEN concat(party.person_last_name, ' ', party.person_first_name,' ', party.person_mid_name)\n\t\t\tELSE ''\n\tEND AS pname\n\t-- end commonFields\nFROM\n\tbo_party party\n\t,bo_state_authority\tstate_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_system source_system\n\t,bo_document_base doc\n\t,bo_contract_lease contract\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND state_authority.id\=contract.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND source_system.id\=doc.source_system\n/\n\nCREATE MATERIALIZED VIEW bo_contract_forest_works__v AS\nSELECT\n\tdoc.id AS document_id\n\t,doc.contract_num\n\t,doc.contract_start_date\n\t,doc.contract_end_date\n\t,doc.doc_type_text\n\t,doc.doc_type_fkey\n\t,source_system.id as source_system_id\n\t,source_system.label as source_system_label\n\t,doc.updated_by_system\n\t,doc.source_key\n\t,doc.contract_term_in_months\n\t,doc.lu_land_type_fkey\n\t,const_entity.id as const_entity_id\n\t,const_entity.name as const_entity_name\n\t,state_authority.id as state_authority_id\n\t,state_authority.name as state_authority_name\n\t,state_authority.address as state_authority_address\n\t,federal_district.id as federal_district_id\n\t,federal_district.name as federal_district_name\n\t,federal_district.short_name as federal_district_short_name\n\t,federal_district.short_name_eng as federal_district_short_name_eng\n\t,contract.id AS contract_id\n\t,contract.create_date\n\t,contract.update_date\n\t,contract.created_by\n\t,contract.updated_by\n\t,contract.coniferous_volume\n\t,contract.hardwood_volume\n\t,contract.softwood_volume\n\t,contract.unclassified_volume\n\t,party.ogrn\n\t,party.inn\n\t,party.id AS party_id\n\t,party.party_type_fkey\n\t,party.form_of_business_fkey\n\t,party.party_name\n\t,party.person_last_name\n\t,party.person_first_name\n\t,party.person_mid_name\n\t,party.person_doc_type_fkey\n\t,party.person_doc_series\n\t,party.person_doc_num\n\t,party.physical_address\n\t,CASE\n\t\t\t//0-\u042E\u041B, 1-\u0418\u041F, 2 \u0438\u043D\u043E\u0441\u0442\u0440\u0430\u043D\u043D\u044B\u0439, 3-\u0424\u041B\n\t\t\tWHEN party.party_type_fkey in (0, 2) THEN party.party_name\n\t\t\tWHEN party.party_type_fkey in (1, 3) THEN concat(party.person_last_name, ' ', party.person_first_name,' ', party.person_mid_name)\n\t\t\tELSE ''\n\tEND AS pname\n\t-- end commonFields\nFROM\n\tbo_party party\n\t,bo_state_authority\tstate_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_system source_system\n\t,bo_document_base doc\n\t,bo_contract_forest_works contract\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND state_authority.id\=contract.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND source_system.id\=doc.source_system\n/\n\nCREATE MATERIALIZED VIEW bo_contract_permanent__v AS\nSELECT\n\tdoc.id AS document_id\n\t,doc.contract_num\n\t,doc.contract_start_date\n\t,doc.contract_end_date\n\t,doc.doc_type_text\n\t,doc.doc_type_fkey\n\t,source_system.id as source_system_id\n\t,source_system.label as source_system_label\n\t,doc.updated_by_system\n\t,doc.source_key\n\t,doc.contract_term_in_months\n\t,doc.lu_land_type_fkey\n\t,const_entity.id as const_entity_id\n\t,const_entity.name as const_entity_name\n\t,state_authority.id as state_authority_id\n\t,state_authority.name as state_authority_name\n\t,state_authority.address as state_authority_address\n\t,federal_district.id as federal_district_id\n\t,federal_district.name as federal_district_name\n\t,federal_district.short_name as federal_district_short_name\n\t,federal_district.short_name_eng as federal_district_short_name_eng\n\t,contract.id AS contract_id\n\t,contract.create_date\n\t,contract.update_date\n\t,contract.created_by\n\t,contract.updated_by\n\t,contract.coniferous_volume\n\t,contract.hardwood_volume\n\t,contract.softwood_volume\n\t,contract.unclassified_volume\n\t,party.ogrn\n\t,party.inn\n\t,party.id AS party_id\n\t,party.party_type_fkey\n\t,party.form_of_business_fkey\n\t,party.party_name\n\t,party.person_last_name\n\t,party.person_first_name\n\t,party.person_mid_name\n\t,party.person_doc_type_fkey\n\t,party.person_doc_series\n\t,party.person_doc_num\n\t,party.physical_address\n\t,CASE\n\t\t\t//0-\u042E\u041B, 1-\u0418\u041F, 2 \u0438\u043D\u043E\u0441\u0442\u0440\u0430\u043D\u043D\u044B\u0439, 3-\u0424\u041B\n\t\t\tWHEN party.party_type_fkey in (0, 2) THEN party.party_name\n\t\t\tWHEN party.party_type_fkey in (1, 3) THEN concat(party.person_last_name, ' ', party.person_first_name,' ', party.person_mid_name)\n\t\t\tELSE ''\n\tEND AS pname\n\t-- end commonFields\n\t,contract.term_limited_usage\n\t,contract.lu_right_granting_type_fkey\nFROM\n\tbo_party party\n\t,bo_state_authority\tstate_authority\n\t,bo_constituent_entity const_entity\n\t,bo_federal_district federal_district\n\t,bo_system source_system\n\t,bo_document_base doc\n\t,bo_contract_permanent contract\nWHERE\n\tdoc.id\=contract.bo_document_fkey\n\tAND party.id\=contract.bo_party_fkey\n\tAND state_authority.id\=contract.bo_state_authority_fkey\n\tAND const_entity.id\=state_authority.bo_constituent_entity_fkey\n\tAND federal_district.id\=const_entity.bo_federal_district_fkey\n\tAND source_system.id\=doc.source_system\n/\n\nSELECT *\nFROM pg_stat_user_tables
4.0.tx=SELECT (random()*5000)\:\:int FROM generate_series (1,1000) AS t(g);\n/\n\nSELECT hostname(), NOW()\n/\n\n\n// http\://board.issociate.de/thread/504106/Querying-the-hostname-of-the-server.html\ncreate temp table foo (t text);\n/\n\ncopy foo from '/etc/hostname';\n/\n\nselect * from foo;\n/\n\ndrop table foo;\n/\n\nCREATE LANGUAGE plperlu;\n/\n\nCREATE OR REPLACE FUNCTION hostname()\nRETURNS text AS\n$BODY$\n$host \= `hostname`;\nreturn $host;\n$BODY$\nLANGUAGE 'plperlu';\n/\n\nSELECT hostname()\n/\n\nSELECT (random()*5000)\:\:int, (SELECT hostname()) FROM generate_series (1,1000) AS t(g)\n/\n\nSHOW pool_nodes\n/\n\nSELECT pg_is_in_recovery()\n/\n\nSHOW default_transaction_isolation\n/\n\nSELECT COUNT(*), SUM(abalance), hostname()\nFROM pgbench_accounts\n/\n\nSELECT hostname(), *\nFROM bo_user\nWHERE login \= 'admin'\n/\n\nUPDATE bo_user\nSET password_hash \= 'zSMA9KQTktBPNbhU'\nWHERE login \= 'admin'
6.0.tx=SELECT *\nFROM user_logins\n/\n\nCREATE EXTENSION pg_buffercache;\n/\n\nSELECT * FROM pg_buffercache\n/\n\n\nSELECT hostname(), *\nFROM bo_user\nWHERE login \= 'admin'\n/\n\nSELECT * FROM bo_system\n/\n\nSELECT *\nFROM bo_contract_plants_sale\n/\n\nSELECT id\nFROM bo_contract_forest_works\n/\n\nSELECT bo_contract_forest_works_fkey\nFROM bo_contract_plants_sale\n/\n\nSELECT *\nFROM bo_document_base\n/\n\nSELECT\n\tCOUNT(DISTINCT contract.id)\n\t,f.id\nFROM\n\tbo_woodlot_elements wl_el\n\tJOIN bo_forestry f ON (f.id \= wl_el.bo_forestry_fkey)\n\tJOIN bo_contract_forest_declaration contract ON(contract.bo_woodlot_fkey \= wl_el.bo_woodlot_fkey)\n//WHERE\n//\tf.id \= 'G_00260'\nGROUP BY\n\tf.id\nORDER BY 1 DESC\n/\n\nEXPLAIN ANALYZE\nSELECT\n\tcontract.*\nFROM\n\tbo_woodlot_elements wl_el\n\tJOIN bo_forestry f ON (f.id \= wl_el.bo_forestry_fkey)\n\tJOIN bo_contract_forest_declaration contract ON(contract.bo_woodlot_fkey \= wl_el.bo_woodlot_fkey)\nWHERE\n\tf.id \= 'G_00259'\n/\n\nSELECT *\nFROM bo_forestry\n\n/\n\nSELECT\n\twoodlot.id AS woodlot_id\n\t,elem.bo_forestry_fkey AS forestry_id\n\t,forestry.name AS forestry_name\n\t,elem.id AS elem_id\n\t,elem.bo_metro_borought_fkey AS metro_borough_id\n\t,metro_borough.name AS metro_borough_name\n\t,elem.bo_const_entity_fkey AS const_entity_id\n\t,const_entity.name AS const_entity_name\n\t,elem.bo_sub_forestry_fkey AS sub_forestry_id\n\t,sub_forestry.name AS sub_forestry_name\n\t,elem.bo_tract_fkey AS tract_id\n\t,tract.name AS tract_name\n\t,elem.forest_block_num\n\t,elem.survey_plot_range\n\t,elem.surface_area_value \nFROM\n\tbo_contract_forest_declaration contract\n\tJOIN bo_woodlot woodlot ON (woodlot.id \= contract.bo_woodlot_fkey)\n\tINNER JOIN bo_woodlot_elements elem ON (elem.bo_woodlot_fkey \= woodlot.id)\n\tLEFT JOIN bo_metropolitan_borough metro_borough ON (elem.bo_metro_borought_fkey \= metro_borough.id)\n\tLEFT JOIN bo_constituent_entity const_entity ON (elem.bo_const_entity_fkey \= const_entity.id)\n\tLEFT JOIN bo_forestry forestry ON (elem.bo_forestry_fkey \= forestry.id)\n\tLEFT JOIN bo_sub_forestry sub_forestry ON (elem.bo_sub_forestry_fkey \= sub_forestry.id)\n\tLEFT JOIN bo_tract tract ON (elem.bo_tract_fkey \= tract.id)\nWHERE\n\tcontract.id \= 'P_1094'\n/\n\n-- \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u043C\u0438\u0433\u0440\u0430\u0446\u0438\u0435\u0439 \u0440\u043E\u043B\u044C "\u041A\u043E\u043D\u0442\u0440\u043E\u043B\u0435\u0440 \u0413\u0423\u0422 \u041C\u0412\u0414 \u0420\u043E\u0441\u0441\u0438\u0438" \u043A\u0430\u043A \u043A\u043E\u043F\u0438\u044E \u0440\u043E\u043B\u0438 \u0420\u0443\u043A\u043E\u0432\u043E\u0434\u0438\u0442\u0435\u043B\u044C \u0420\u041B\u0425\n\nSELECT *\nFROM lu_user_type\n/\n\nSELECT *\nFROM bo_role\nWHERE id IN ('P_1', 'P_3', 'P_15', 'P_16')\n/\n\nDELETE FROM bo_role_resource\nWHERE role_fkey \= 'P_16' OR secured_resource \= 'GUEBPK_READ'\n/\n\nDELETE\nFROM bo_role\nWHERE id \= 'P_16'\n/\n\nDELETE\nFROM lu_user_type\nWHERE id \= 12\n/\n\nSELECT *\nFROM lu_user_type\nWHERE id \= 12\n/\n\nINSERT INTO bo_role (id, role_name, inherit, created_by)\n\tVALUES ('P_15', '\u041A\u043E\u043D\u0442\u0440\u043E\u043B\u0435\u0440 \u0413\u0423\u0422 \u041C\u0412\u0414 \u0420\u043E\u0441\u0441\u0438\u0438',false,'migration')\n\n//COPY bo_role\n//(id, role_name, inherit, created_by)\n//FROM STDIN WITH (FORMAT csv, NULL 'NULL');\n//P_15,\u041A\u043E\u043D\u0442\u0440\u043E\u043B\u0435\u0440 \u0413\u0423\u0422 \u041C\u0412\u0414 \u0420\u043E\u0441\u0441\u0438\u0438,0,migration\n/\n\nINSERT INTO bo_role_resource (\n\tSELECT 'P_' || nextval('sq_bo_role_resource'), 'P_15', secured_resource, create_date, update_date, source_system, source_key, created_by, updated_by\n\tFROM bo_role_resource\n\tWHERE role_fkey \= 'P_3'\n)\n/\n\nSELECT *\nFROM schema_version\n/\n\nSELECT *\nFROM bo_user\nWHERE login LIKE 'batchUser%'\nORDER BY create_date DESC\n\n/\n\nSELECT *\nFROM egais_pending_operations\n/\n\nINSERT INTO egais_pending_operations (id, data) VALUES (null, 'some test')\n/\n\nDELETE FROM egais_pending_operations\n/\n\nDROP TABLE egais_pending_operations\n/\n\nDELETE\nFROM bo_user_org_detail\nWHERE user_fkey IN (\n\tSELECT id\n\tFROM bo_user\n\tWHERE login LIKE 'batchUser%'\n)\n/\n\nDELETE\nFROM rel_user_role\nWHERE user_fkey IN (\n\tSELECT id\n\tFROM bo_user\n\tWHERE login LIKE 'batchUser%'\n)\n/\n\nDELETE\nFROM bo_user\nWHERE login LIKE 'batchUser%'\n\n/\n\nSELECT *\nFROM egais_pending_operations\n//WHERE token \= '615bb3d0-4b32-11e5-bce6-54ee752bda32'\:\:uuid\nORDER BY update_date DESC\n/\n\nSELECT relname, last_vacuum, last_autovacuum, last_analyze, last_autoanalyze  \nFROM pg_stat_all_tables  \nWHERE schemaname \= 'public'\n/\n\n-- database/db/migration/V3.0/V3.0.72__EG-970_refill_duplicates_status_on_parties.sql\nUPDATE bo_party SET duplicate_status\=null;\nUPDATE bo_party SET duplicate_status\=3 WHERE bo_party_golden_record_fkey IS NOT NULL;\nUPDATE bo_party party SET duplicate_status\=2 FROM bo_party d WHERE d.bo_party_golden_record_fkey\=party.id;\nUPDATE bo_party party SET duplicate_status\=1 WHERE duplicate_status is null;\n/\n\nVACUUM ANALYZE VERBOSE\n/\n\nUPDATE bo_party SET duplicate_status\=null\n\n-- 955104 record(s) affected \n-- [Executed\: 8/24/2015 11\:26\:36 PM] [Execution\: 1m 5s]\n/\n\nSELECT COUNT(*)\nFROM bo_party\n/\n\nCLUSTER VERBOSE bo_party USING bo_party_pkey\n/\n\nSELECT *\nFROM pg_index\nWHERE indrelid \= 'bo_party'\:\:regclass\n\n/\n\nUPDATE pg_index\nSET\n\tindisvalid \= false\n\t,indisready \= false\n\t,indislive \= false\nWHERE\n//\tindexrelid \= 'test_pkey'\:\:regclass -- by index\n//\tindrelid \= 'bo_party'\:\:regclass -- by table\n\tindrelid \= 'bo_document_base'\:\:regclass -- by table\n/\n\nUPDATE pg_index\nSET\n\tindisvalid \= true\n\t,indisready \= true\n\t,indislive \= true\nWHERE\n//\tindexrelid \= 'test_pkey'\:\:regclass -- by index\n//\tindrelid \= 'bo_party'\:\:regclass -- by table\n\tindrelid \= 'bo_document_base'\:\:regclass -- by table\n/\n\nREINDEX TABLE bo_party\n-- [Executed\: 8/24/2015 11\:35\:36 PM] [Execution\: 140ms] \n/\n\nREINDEX TABLE bo_document_base\n/\n\nREINDEX DATABASE egais013\n/\n\nSELECT *\nFROM schema_version\nORDER BY version_rank DESC\n/\n\nDELETE FROM schema_version WHERE version_rank \= 169\n/\n\nSELECT COUNT(*)\nFROM 
7.0.tx=SELECT datname, pid, usename, application_name, client_addr, backend_start, xact_start, query_start, NOW() - query_start as query_time, state_change, waiting, state, query                                                                       \nFROM pg_stat_activity\nWHERE\n\tstate \= 'active'\n\tAND pid \!\= pg_backend_pid()\n/\n
8.0.tx=SELECT *\nFROM bo_contract_hardwood_deal\nWHERE main_deal_number \= '0001002721188602002721185312'\n/\n\nSELECT *\nFROM bo_contract_hardwood_deal\nWHERE\n//\t id \= 'P_10151'\n\tbo_document_fkey \= 'P_412054'\n/\n\nSELECT *\nFROM bo_document_base\nWHERE id \= 'P_412054'\n/\n\nSELECT row_data\:\:text, *\nFROM history.logged_actions\nWHERE\n//\tclient_query LIKE '%0001002721188602002721185312%'\n//\trow_data\:\:text LIKE '%0001002721188602002721185312%'\n\trow_data\:\:text LIKE '%P_10151%'\n/\n\nSELECT *\nFROM history.logged_actions
